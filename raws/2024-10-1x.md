# My Python TUI Project Template

*How I aim to start every new Python TUI project from now on using uv, Textual and Nuitka.*

I think a lot about managing my Python projects these days and I've recently converted to poetry, as shown in my [previous post](2024-09-28.md). I have however been hearing a lot about [uv](https://github.com/astral-sh/uv) and [Python Bytes' episode 404](https://pythonbytes.fm/episodes/show/404/the-lost-episode)'s reference to Hynek's video [uv IS the Future of Python Packaging](https://www.youtube.com/watch?v=8UuW8o4bHbw) convinced me to give it a try. Hynek explains it better than I could, it's worth watching.

The other thing I've been meaning to try for a while is [Textual](https://textual.textualize.io/) to build terminal user interfaces (TUI). Something about its aesthetics, usage and capabilities is so very satisfying. Its flexibility means that I could use it for many types of applications, and it would be quite smaller as a single file program (compiled with [Nuitka](https://nuitka.net/)).

[Installing UV](https://docs.astral.sh/uv/getting-started/installation/)

## UV, Nuitka

### Basic Setup

```sh
mkdir my_project
cd my_project
git init
uv init
uv add rich_click
uv add --dev black nuitka pre-commit pytest
```

Content of `.pre-commit-config.yaml`:

```yaml
repos:
-   repo: https://github.com/pre-commit/pre-commit-hooks
    rev: v5.0.0
    hooks:
    -   id: trailing-whitespace
    -   id: end-of-file-fixer
    -   id: check-yaml
    -   id: check-added-large-files
-   repo: https://github.com/psf/black
    rev: 24.10.0
    hooks:
    -   id: black
```

```sh
uv run pre-commit install
uv run pre-commit
```

```
$ uv run hello.py
Hello from uv-nuitka-template!
```

### Rich-Click and Pytest Integration

New project structure:

```
├── app
│   ├── hello.py
│   ├── __init__.py
├── .gitignore
├── .pre-commit-config.yaml
├── .python-version
├── pyproject.toml
├── README.md
├── tests
│   ├── __init__.py
│   └── test_hello.py
├── uv.lock
└── .venv
```

Content of `app/hello.py`:

```python
import rich_click as click


@click.command()
@click.argument("name")
def main(name: str):
    print(f"Hello {name}!")


if __name__ == "__main__":
    main()
```

Content of `tests/test_hello.py`:

```python
from click.testing import CliRunner, Result
import pytest
from app.hello import main


@pytest.fixture
def runner() -> CliRunner:
    return CliRunner()


def test_main_hello(runner: CliRunner):
    result: Result = runner.invoke(main, ["Michel"])
    assert result.exit_code == 0
    assert "Hello Michel!" in result.output
```

Content of `.gitignore`:

```
*.bin
*.build
.mypy_cache
__pycache__
.pytest_cache
.venv
```

```bash
$ uv run pytest --quiet
.                                                                                                     [100%]
1 passed in 0.04s
```

### Nuitka Compilation

Check [Nuitka's Manual](https://nuitka.net/user-documentation/) for details.

Content of `Makefile`:

```Makefile
build:
	# Replace --onefile with --standalone if desired.
	# Needs to be adapted for Windows.
	# See https://nuitka.net/user-documentation/ for details
	uv run nuitka --onefile --static-libpython=yes app/hello.py
```

The app can then be compiled with:

```bash
make compile
```

>Depending on your system, you may need to install a few compilation tools such as `cmake`, `ccache` and `patchelf`; check [Nuitka's Manual](https://nuitka.net/user-documentation/) and its error messages for guidance .